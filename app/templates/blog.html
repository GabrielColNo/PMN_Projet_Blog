{% extends "base.html" %}

{% block title %}Blog - Presspedia{% endblock %}

{% block content %}
  <section class="page-hero">
    <div class="container">
      <h1 class="page-title">Blog</h1>
      <p class="page-subtitle">D√©couvrez tous les articles ou partagez le v√¥tre</p>
      <a href="{{ url_for('main.write_article') }}" class="btn-write">‚úçÔ∏è √âcrire un article</a>
    </div>
  </section>

  <section class="blog-content">
    <div class="container">
      <!-- Search and Filters -->
      <div class="filters-section">
        <form method="get" action="{{ url_for('main.blog') }}" class="filters-form">
          <div class="search-box">
            <input type="text" name="search" placeholder="üîç Rechercher un article..." value="{{ current_search }}" />
          </div>
          
          <div class="filter-group">
            <select name="category" onchange="this.form.submit()">
              <option value="">Toutes les cat√©gories</option>
              {% for cat in categories %}
                <option value="{{ cat }}" {% if current_category == cat %}selected{% endif %}>{{ cat }}</option>
              {% endfor %}
            </select>
            
            <select name="author" onchange="this.form.submit()">
              <option value="">Tous les auteurs</option>
              {% for auth in authors %}
                <option value="{{ auth }}" {% if current_author == auth %}selected{% endif %}>{{ auth }}</option>
              {% endfor %}
            </select>
            
            <button type="submit" class="btn-filter">Filtrer</button>
            {% if current_search or current_category or current_author %}
              <a href="{{ url_for('main.blog') }}" class="btn-clear">‚úñ Effacer</a>
            {% endif %}
          </div>
        </form>
      </div>
      {% if articles %}
        <div class="article-grid">
          {% for article in articles %}
            <div class="article-card">
              {% if article.image_filename %}
                <div class="article-card-image">
                  <img src="{{ url_for('static', filename='uploads/' + article.image_filename) }}" alt="{{ article.title }}" />
                </div>
              {% endif %}
              <h3>
                <a href="{{ url_for('main.article_detail', slug=article.slug) }}">
                  {{ article.title }}
                </a>
              </h3>
              <p class="article-meta">
                <a href="{{ url_for('main.blog', author=article.author) }}" class="author-link">{{ article.author or 'Anonyme' }}</a>
                ‚Ä¢ {{ article.created_at.strftime('%d/%m/%Y') if article.created_at else 'N/A' }}
                {% if article.category %}
                  ‚Ä¢ <span class="category-badge">{{ article.category }}</span>
                {% endif %}
              </p>
              {% if article.tags %}
                <div class="tags">
                  {% for tag in article.tags.split(',') %}
                    <span class="tag">#{{ tag.strip() }}</span>
                  {% endfor %}
                </div>
              {% endif %}
              <p class="article-excerpt">
                {{ article.content[:150] }}{% if article.content|length > 150 %}...{% endif %}
              </p>
              <div class="article-stats">
                <span class="stat-item">
                  <img src="{{ url_for('static', filename='lovee.png') }}" alt="J'aime" class="stat-icon" />
                  {{ article.likes or 0 }}
                </span>
                <span class="stat-item">
                  <img src="{{ url_for('static', filename='dislikee.png') }}" alt="Je n'aime pas" class="stat-icon" />
                  {{ article.dislikes or 0 }}
                </span>
                <span class="stat-item">
                  üí¨ {{ article.comments|length if article.comments else 0 }}
                </span>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p class="no-articles">Aucun article pour le moment. Soyez le premier √† √©crire !</p>
      {% endif %}
    </div>
  </section>
{% endblock %}
